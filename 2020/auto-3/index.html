<!DOCTYPE html>


<html lang="zh-CN" >


<head>
  <meta charset="utf-8" />
    
  <meta name="description" content="A Dreamer" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    高等级自动驾驶下的汽车车身设计 |  樱桃虾的秘密花园
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

<link rel="alternate" href="/atom.xml" title="樱桃虾的秘密花园" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    <main class="content on">
      <section class="outer">
  <article id="post-auto-3" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  高等级自动驾驶下的汽车车身设计
</h1>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/auto-3/" class="article-date">
  <time datetime="2020-05-25T01:12:34.000Z" itemprop="datePublished">2020-05-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a>
  </div>

      
      
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">2.4k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">8 分钟</span>
        </span>
    </span>
</div>

      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <p>200525 汽车设计作业</p>
<ol>
<li>撰写一篇主题围绕“高等级自动驾驶下的汽车车身设计”的分析文章；</li>
<li>需要自定义所分析的“自动驾驶”的功能和作用域；</li>
<li>资料引用；</li>
<li>逻辑严密；</li>
<li>表述清晰；</li>
</ol>
<span id="more"></span>

<p>[TOC]</p>
<h1 id="一、未来自动驾驶的前景"><a href="#一、未来自动驾驶的前景" class="headerlink" title="一、未来自动驾驶的前景"></a>一、未来自动驾驶的前景</h1><h2 id="1-1-动力来源"><a href="#1-1-动力来源" class="headerlink" title="1.1 动力来源"></a>1.1 动力来源</h2><p>自动驾驶汽车，是一种不需要人类操作即能感知周围环境并导航的载具。其以毫米波雷达、激光雷达、摄像头以及其他传感器感知环境，并由决策和规划系统切换适当的行驶路径，识别障碍和其他相关标志。以上三层：感知层、决策层、规划层对于不同车辆差距不大；而在控制层，电动汽车相比传统燃油车具有先天优势。在纵向控制方面，燃油车需要控制同时控制发动机和变速器，实现难度大；而电动车通常只需控制电动机，控制算法更容易实现。<a target="_blank" rel="noopener" href="http://suo.im/5SV3Ia">^1</a></p>
<p>此外，电动车的动力响应比燃油车更快，意味着燃油车在紧急情况下控制系统的延迟可能会造成更严重的后果。而且动力源的转变是世界大势所趋，因此未来的乘用车将普遍实现电动化和智能化。</p>
<h2 id="1-2-自动驾驶级别"><a href="#1-2-自动驾驶级别" class="headerlink" title="1.2 自动驾驶级别"></a>1.2 自动驾驶级别</h2><p><img src="https://s1.ax1x.com/2020/05/24/tS4aaF.png" alt="表1: SAE对于驾驶自动化的划分"></p>
<p>表1: SAE对于驾驶自动化的划分 [^2] </p>
<p>按照SAE对驾驶自动化等级最新定义（J3016_201806），L3~L5才是真正意义上的自动驾驶，即由自动驾驶系统接管全部的DDT（动态驾驶任务）。相比之下L2需要驾驶员实现全部的OEDR（物体和事件检测与响应），这意味驾驶员仍然要保持全神贯注；正因如此，从L2到L3是一个质的飞跃。目前部分车企已经达到了L2级别，如Tesla，Audi等，但L3级别的量产车目前还没有；就算技术上可以实现，由于法规限制也无法开放所有的功能。</p>
<p>而在高等级自动驾驶中，最高的L5级别的特征是可以实现在无限制的ODD（操作设计区域）内运行，这要求时效性更高的高精度定位/高精度地图，以及更出色的摄像头和视觉识别；而从现有技术来看，以上两点实现难度非常大。因此在未来5~10年，如果能突破从L2到L3的一系列障碍（包括技术上和法规上），那么L3和L4的量产指日可待。</p>
<p>而L3和L4的差距在于DDT失效时的备份计划。L3在系统失效或离开ODD时请求驾驶员接管，此后由驾驶员决定手动驾驶还是进入MRC（最小风险状态）；L4同样会优先请求驾驶员接管，但如果驾驶没有响应，则自动进入MRC状态以避免危险。此处的MRC应做到避免直接停车或车道内停车，而是选择路边或路肩（如果有的话）停车，行驶至下一个收费站或停车至指定位置。</p>
<p>但这也意味着L3级别的自动驾驶系统应对突发状况时仍然需要驾驶员介入。而L3的寻常场景下驾驶员的身份是只是乘客，在遇到突发情况首先要以合理的方式被自动驾驶系统提醒，并完成车辆控制权的交接；其次需要驾驶员迅速观察以了解车辆周围环境——这和自动驾驶系统的宗旨是冲突的，正因如此有些车企把重心放在L4上，以及L2.5，L2.9称号的产生。我认为如果不考虑市场因素，单纯考虑技术，L3的确是无法完全依靠的，更适合作为L2和L4的过渡形态而不是量产。</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tkseMt.jpg" alt="WEY品牌新产品规划"></p>
<p>WEY品牌新产品规划</p>
<p>综上所述，我对未来5~10年自动驾驶系统的发展程度，更倾向于L4级别。</p>
<h1 id="二、L4自动驾驶的功能和作用域"><a href="#二、L4自动驾驶的功能和作用域" class="headerlink" title="二、L4自动驾驶的功能和作用域"></a>二、L4自动驾驶的功能和作用域</h1><h2 id="2-1-适用区域"><a href="#2-1-适用区域" class="headerlink" title="2.1 适用区域"></a>2.1 适用区域</h2><h3 id="2-2-1-乘用车"><a href="#2-2-1-乘用车" class="headerlink" title="2.2.1 乘用车"></a>2.2.1 乘用车</h3><p> 由于L4级别自动驾驶系统仍然需要限制ODD，这意味着只能适用于某些特殊场景。目前Audi A8搭载的奥迪AI交通拥堵驾驶系统，限定条件为：</p>
<p>1.行驶在有对向车流隔离带的高速公路上或多车道公路上；</p>
<p>2.所有车道的车行驶缓慢，车辆间距非常小；</p>
<p>3.车速不超过60公里/小时；</p>
<p>4.车辆传感器监控范围内没有交通信号灯或行人； </p>
<p>可见这是一个相对简单的场景，排除了行人和交通信号灯的干扰。我认为未来乘用车上的自动驾驶系统应该更多聚焦在类似的场景下——场景简单，驾驶枯燥，比如高速路段、城市快速路，这也同奥迪规划相符 [^3] 。而广汽将L3定义为高精地图全路段的全速域自动驾驶，即在高精地图覆盖的高速路、城市快速路的全路段范围内，实现0-120km/h的全速域自动驾驶。在这个基础上增加应急避险功能即接近L4级别自动驾驶定义。</p>
<h3 id="2-2-2-商用车"><a href="#2-2-2-商用车" class="headerlink" title="2.2.2 商用车"></a>2.2.2 商用车</h3><p>自动驾驶可在封闭场景，比如机场、港口中，遵循调度安排，可按照设计路径运行运送物资；或者在校园、企业园区内接送乘客 [^4] 。对于卡车等固定线路的运输车辆，如果路况允许也可使用自动驾驶。</p>
<h2 id="2-2-实现功能"><a href="#2-2-实现功能" class="headerlink" title="2.2 实现功能"></a>2.2 实现功能</h2><h3 id="2-2-1-应急处理"><a href="#2-2-1-应急处理" class="headerlink" title="2.2.1  应急处理"></a>2.2.1  应急处理</h3><p>安全性应当永远处于第一位。在自动驾驶系统失效时应自动执行应急方案，选择乘客作为驾驶员继续行驶并完成控制权交接；如果乘客无响应，应当立即进入最小风险状态，变至边缘车道并停车，打开双闪。同时通过驾驶舱内摄像头检测乘客是否有活动，如果发现异常可自动报警。相比L3级别的车道内停车更加安全。</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tks6Q1.png" alt="图2: L4自动驾驶系统失效后流程"></p>
<p>图2: L4自动驾驶系统失效后流程 [^5] </p>
<h3 id="2-2-2-场地内按预定路径行驶"><a href="#2-2-2-场地内按预定路径行驶" class="headerlink" title="2.2.2 场地内按预定路径行驶"></a>2.2.2 场地内按预定路径行驶</h3><p>乘用车可以行驶至任何场景，而场地内车辆运行场景往往单一，比如在港口内完成集装箱的运输，可自行规划路线或人工调度，打造高效智能的无人港口；在企业内可作为运输车辆运输生产资料，或者作为员工代步车。</p>
<h3 id="2-2-3-高速、拥堵路上自动驾驶"><a href="#2-2-3-高速、拥堵路上自动驾驶" class="headerlink" title="2.2.3 高速、拥堵路上自动驾驶"></a>2.2.3 高速、拥堵路上自动驾驶</h3><p>在少有行人和交通信号灯的干扰下，自动驾驶系统可以把驾驶员从单调的驾驶环境中解脱。而在这种路况下，应通过环境感知确保车道不偏离，与前车保持一定距离，保持一定车速。例如Audi A8通过前视摄像头检测车道线；假如出现车道线遮挡情况，A8也能利用前向远程毫米波雷达跟随前车的方式，保持在车道内行驶；与此同时，激光雷达会不断探测车子到道路边沿的距离，根据这一参照，确保车辆不会偏离所在车道。</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>Audi A8</th>
</tr>
</thead>
<tbody><tr>
<td>激光雷达</td>
<td>1</td>
</tr>
<tr>
<td>前视摄像头</td>
<td>1</td>
</tr>
<tr>
<td>中距离雷达</td>
<td>1</td>
</tr>
<tr>
<td>短距角雷达</td>
<td>4</td>
</tr>
<tr>
<td>环视摄像头</td>
<td>4</td>
</tr>
<tr>
<td>超声波雷达</td>
<td>12</td>
</tr>
<tr>
<td>驾驶员检测摄像头</td>
<td>1</td>
</tr>
</tbody></table>
<p>Audi A8上的硬件设施</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tks7QI.jpg" alt="图3: 奥迪A8自动驾驶系统(L3)失效后流程"></p>
<p>图3: 奥迪A8自动驾驶系统(L3)失效后流程 [^6] </p>
<h1 id="三、自动驾驶对车身设计的影响"><a href="#三、自动驾驶对车身设计的影响" class="headerlink" title="三、自动驾驶对车身设计的影响"></a>三、自动驾驶对车身设计的影响</h1><h2 id="3-1-外形设计"><a href="#3-1-外形设计" class="headerlink" title="3.1 外形设计"></a>3.1 外形设计</h2><p>由于自动驾驶系统的存在，驾驶员视野的设计限制可放宽，如前风窗可以有更大的倾斜角度；加上电动汽车的特征，前舱也可进一步缩短，这样车身线条更加流畅，降低风阻。</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tksXTS.jpg" alt="Mercedes-Benz F015 Luxury in Motion"></p>
<p>Mercedes-Benz F015 Luxury in Motion [^7] </p>
<p><img src="https://s1.ax1x.com/2020/05/27/tkyPO0.jpg" alt="Volvo 360c autonomous concept"></p>
<p>Volvo 360c autonomous concept [^8] </p>
<h2 id="3-2-内饰设计"><a href="#3-2-内饰设计" class="headerlink" title="3.2 内饰设计"></a>3.2 内饰设计</h2><p>由于L4级别自动驾驶系统允许乘客在舱内有更大的自由度，而不是必须时刻关注路况，因此乘客可以更自由地交谈、休息。将前排座椅转向后面是一种不错的想法，乘员舱更加整体化。</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tkynp9.jpg" alt="Mercedes-Benz F015 Luxury in Motion"></p>
<p>Mercedes-Benz F015 Luxury in Motion 内部 [^7] </p>
<p>为了节约空间，也出现了隐藏式方向盘和小桌板的设计，不仅节约空间，而且把汽车座舱打造成飞机头等舱的氛围，使得行驶过程更加惬意。</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tkyGkD.gif" alt="Audi AI ME"></p>
<p>Audi AI ME</p>
<p><img src="https://s1.ax1x.com/2020/05/27/tky3TO.gif" alt="BMW Next 100"></p>
<p>BMW Next 100 [^9] </p>
<p>以及更强的人机交互，更大的屏幕，这也是最近追求未来感和科技感的潮流。</p>
<p><img src="https://pic3.zhimg.com/80/v2-456e410ab83d5d9ec01d74f0db5a4cea_1440w.jpg" alt="nissan xmotion concept"></p>
<p>nissan xmotion concept</p>
<h2 id="3-3-结构设计"><a href="#3-3-结构设计" class="headerlink" title="3.3 结构设计"></a>3.3 结构设计</h2><p>由于L4级别的汽车仍然可能需要手动驾驶，因此把汽车做成“车轮上的卧室”是不现实的；而且从安全性来看，目前的框架结构是现在最优的选择。因此在车身结构上因为自动驾驶系统的加入而做出大的改进是不可能的。</p>
<h1 id="四、参考资料"><a href="#四、参考资料" class="headerlink" title="四、参考资料"></a>四、参考资料</h1><p>[^2]: P19, J3016_201806, SAE International<br>[^3]: <a target="_blank" rel="noopener" href="https://media.audiusa.com/models/piloted-driving">https://media.audiusa.com/models/piloted-driving</a><br>[^4]: P4, J3016_201806, SAE International<br>[^5]: P10, J3016_201806, SAE International<br>[^6]: <a target="_blank" rel="noopener" href="https://audimediacenter-a.akamaihd.net/system/production/media/15520/images/97db3c9d33a122499118010e384fb34a2c1979e1/A8130083_full.jpg?1582188724">https://audimediacenter-a.akamaihd.net/system/production/media/15520/images/97db3c9d33a122499118010e384fb34a2c1979e1/A8130083_full.jpg?1582188724</a><br>[^7]: <a target="_blank" rel="noopener" href="https://www.carbodydesign.com/set/55819/mercedes-benz-f015-luxury-in-motion-design-gallery/">https://www.carbodydesign.com/set/55819/mercedes-benz-f015-luxury-in-motion-design-gallery/</a><br>[^8]: <a target="_blank" rel="noopener" href="https://www.carbodydesign.com/2018/09/volvo-360c-autonomous-concept/">https://www.carbodydesign.com/2018/09/volvo-360c-autonomous-concept/</a><br>[^9]: <a target="_blank" rel="noopener" href="https://www.bmw.com.cn/zh/topics/experience/bmw-next-100/bmw-vision.next-100.html">https://www.bmw.com.cn/zh/topics/experience/bmw-next-100/bmw-vision.next-100.html</a></p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
        <div class="declare">
          <ul class="post-copyright">
            <li>
              <i class="ri-copyright-line"></i>
              <strong>版权声明： </strong>
              本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
            </li>
          </ul>
        </div>
        
    <footer class="article-footer">
      
          
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2020/auto-3/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B1%BD%E8%BD%A6/" rel="tag">汽车</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9A%8F%E7%AC%94/" rel="tag">随笔</a></li></ul>


    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2020/77-1/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            虾吃
          
        </div>
      </a>
    
    
      <a href="/2020/auto-2/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">汽车设计作业--设计车型</div>
      </a>
    
  </nav>


  

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2020-2021
        steve3ussr
      </li>
      <li>
        
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ohmygirl_logo.svg" alt="樱桃虾的秘密花园"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/OMG/">오마이걸</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://weibo.com/u/6399559434">微博</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2020/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['찾았다,오마이걸！', '人间樱桃柳虾虾~~', '想要的都拥有，得不到的都释怀'],
      startDelay: 0,
      typeSpeed: 200,
      loop: true,
      backSpeed: 50,
      showCursor: true
    });
  } catch (err) {
  }

</script>




<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>



<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>




<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

  
<script src="/js/clickLove.js"></script>



    
  </div>
</body>

</html>